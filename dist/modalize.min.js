/*
 * Modalize - v0.0.1
 * Lightweight, responsive, fast, fully customizable modal plugin. Call your modals by url hash.
 * https://github.com/dominicrico/modalize
 *
 * Made by Dominic Rico-Gomez
 * Under MIT License
 */

!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(c){return b(a,c)}):"object"==typeof exports?b(a,require("jquery")):b(a,a.jQuery||a.Zepto)}(this,function(a,b){"use strict";function c(){for(var a=s,b=0;b<arguments.length;b++)a+="-"+arguments[b];return a}function d(a){if(y&&"none"===a.css("animation-name")&&"none"===a.css("-ms-animation-name")&&"none"===a.css("-o-animation-name")&&"none"===a.css("-moz-animation-name")&&"none"===a.css("-webkit-animation-name"))return 0;var b=a.css("animation-duration")||a.css("-ms-animation-duration")||a.css("-o-animation-duration")||a.css("-moz-animation-duration")||a.css("-webkit-animation-duration")||"0s",c=a.css("animation-delay")||a.css("-ms-animation-delay")||a.css("-o-animation-delay")||a.css("-moz-animation-delay")||a.css("-webkit-animation-delay")||"0s",d=a.css("animation-iteration-count")||a.css("-ms-animation-iteration-count")||a.css("-o-animation-iteration-count")||a.css("-moz-animation-iteration-count")||a.css("-webkit-animation-iteration-count")||"1";b=b.split(", "),c=c.split(", "),d=d.split(", ");for(var e,f=Number.NEGATIVE_INFINITY,g=0;g<b.length;g++)e=parseFloat(b[g])*parseFloat(d[g],10)+parseFloat(c[g]),e>f&&(f=e);return e}function e(a,c){var d=["$bg","$overlay","$wrapper","$modal"];b.each(d,function(b,d){a[d].off(c)})}function f(a,c,d){var e=["$bg","$overlay","$wrapper","$modal"];b.each(e,function(b,e){a[e].on(c,d)})}function g(a){var c,d=a.$modal.find("."+p+"-tabs ul li");a.$modal.find("."+p+"-tabs [data-"+p+"-tab]").hide(),a.$modal.find("."+p+"-tabs [data-"+p+"-tab]:first").show(),b.each(d,function(d,e){c=b(e),void 0!==c.data(p+"-show")&&c.on("click",function(c){c.preventDefault();var d=b(c.currentTarget);a.$modal.find("."+p+"-tabs ."+p+"-tab").hide(),a.$modal.find("."+p+"-tabs [data-"+p+"-tab="+d.data(p+"-show")+"]").show()})})}function h(a){var c,d=a.$modal.find("."+p+"-tabs ul li");a.$modal.find("."+p+"-tabs [data-"+p+"-tab]").hide(),b.each(d,function(a,d){c=b(d),void 0!==c.data(p+"-show")&&c.off("click")})}function i(){if(b(document.body).height()<=b(window).height())return 0;var a,c,d=document.createElement("div"),e=document.createElement("div");return d.style.visibility="hidden",d.style.width="100px",d.style.overflow="scroll",e.style.width="100%",document.body.appendChild(d),d.appendChild(e),c=d.offsetWidth,a=e.offsetWidth,d.parentNode.removeChild(d),c-a}function j(a){var d,e,f=b("html"),g=c("locked");a?f.hasClass(g)||(e=b(document.body),d=parseInt(e.css("padding-right"),10)+i(),e.css("padding-right",d+"px"),f.addClass(g)):f.hasClass(g)&&(e=b(document.body),d=parseInt(e.css("padding-right"),10)-i(),e.css("padding-right",d+"px"),f.removeClass(g))}function k(a,b,d,e){var f=c("is",b),g=[c("is",w.closing),c("is",w.closed),c("is",w.opening),c("is",w.opened)].join(" ");a.$bg.removeClass(g).addClass(f),a.$overlay.removeClass(g).addClass(f),a.$wrapper.removeClass(g).addClass(f),a.$modal.removeClass(g).addClass(f),a.state=b,!d&&a.$modal.trigger({type:b,reason:e},[{reason:e}])}function l(a,b,c){var g=0,h=function(a){a.target===this&&g++},i=function(a){a.target===this&&0===--g&&(e(c,t+" "+u),b())};f(c,t,h),f(c,u,i),a(),0===d(c.$bg)&&0===d(c.$overlay)&&0===d(c.$wrapper)&&0===d(c.$modal)&&(e(c,t+" "+u),b())}function m(a){a.state!==w.closed&&(e(a,t+" "+u),a.$bg.removeClass(a.settings.mods),a.$overlay.removeClass(a.settings.mods).hide(),a.$wrapper.hide(),j(!1),k(a,w.closed,!0))}function n(){var a,c,d=window.location.hash.replace("#","");if(d){try{c=b("[data-"+p+"-id="+d.replace(new RegExp("/","g"),"\\/")+"]")}catch(e){}c&&c.length&&(a=b[p].lookup[c.data(p)],a&&a.settings.trackUrlHash&&a.open())}else q&&q.state===w.opened&&q.settings.trackUrlHash&&q.close()}function o(a,d){var e=b(document.body),f=this;f.settings=b.extend({},v,d),f.index=b[p].lookup.push(f)-1,f.state=w.closed,f.$overlay=b("."+c("overlay")),f.$overlay.length||(f.$overlay=b("<div>").addClass(c("overlay")+" "+c("is",w.closed)).hide(),e.append(f.$overlay)),f.$bg=b("."+c("bg")).addClass(c("is",w.closed)),f.$modal=a.addClass(s+" "+c("is-initialized")+" "+f.settings.mods+" "+c("is",w.closed)).attr("tabindex","-1"),f.$wrapper=b("<div>").addClass(c("wrapper")+" "+f.settings.mods+" "+c("is",w.closed)).hide().append(f.$modal),e.append(f.$wrapper),f.$wrapper.on("click."+s,"[data-"+p+'-action="close"]',function(a){a.preventDefault(),f.close()}),f.$wrapper.on("click."+s,"[data-"+p+'-action="cancel"]',function(a){a.preventDefault(),f.$modal.trigger(x.CANCEL),f.settings.closeOnCancel&&f.close(x.CANCEL)}),f.$wrapper.on("click."+s,"[data-"+p+'-action="confirm"]',function(a){a.preventDefault(),f.$modal.trigger(x.CONFIRM),f.settings.closeOnConfirm&&f.close(x.CONFIRM)}),f.$wrapper.on("click."+s,function(a){b(a.target).hasClass(c("wrapper"))&&f.settings.closeOnOuterClick&&f.close()})}var p="modalize";b[p]={lookup:[]};var q,r,s=a.MODALIZE_GLOBALS&&a.MODALIZE_GLOBALS.NAMESPACE||p,t=b.map(["animationstart","webkitAnimationStart","MSAnimationStart","oAnimationStart"],function(a){return a+"."+s}).join(" "),u=b.map(["animationend","webkitAnimationEnd","MSAnimationEnd","oAnimationEnd"],function(a){return a+"."+s}).join(" "),v=b.extend({trackUrlHash:!0,closeOnConfirm:!0,closeOnCancel:!0,closeOnEsc:!0,closeOnOuterClick:!0,mods:""},a.MODALIZE_GLOBALS&&a.MODALIZE_GLOBALS.DEFAULTS),w={closing:"closing",closed:"closed",opening:"opening",opened:"opened"},x={CONFIRM:"confirmation",CANCEL:"cancellation"},y=function(){var a=document.createElement("div").style;return void 0!==a.animationName||void 0!==a.WebkitAnimationName||void 0!==a.MozAnimationName||void 0!==a.msAnimationName||void 0!==a.OAnimationName}();o.prototype.open=function(){var a,c,d=this;d.state!==w.opening&&d.state!==w.closing&&(a=d.$modal.attr("data-"+p+"-id"),a&&d.settings.trackUrlHash&&(r=b(window).scrollTop(),location.hash=a),q&&q!==d&&m(q),q=d,j(!0),d.$bg.addClass(d.settings.mods),d.$overlay.addClass(d.settings.mods).show(),d.$wrapper.show().scrollTop(),d.$modal.focus(),d.$modal.find("."+p+"-ajax").length&&(d.$modal.find("."+p+"-ajax").empty(),c=d.$modal.find("."+p+"-ajax").data(p+"-ajax"),b.ajax({async:!1,method:"GET",url:c,success:function(a){d.$modal.find("."+p+"-ajax").html(a.output)},error:function(a){d.$modal.find("."+p+"-ajax").html("<span>Ooops... Something went completly wrong! Sorry!</span>")}})),d.$modal.find("."+p+"-tabs").length&&g(d),l(function(){k(d,w.opening)},function(){k(d,w.opened)},d))},o.prototype.close=function(a){var c=this;c.state!==w.opening&&c.state!==w.closing&&(c.settings.trackUrlHash&&c.$modal.attr("data-"+p+"-id")===window.location.hash.substring(1)&&(window.location.hash="",b(window).scrollTop(r)),c.$bg.addClass(c.settings.mods),c.$overlay.addClass(c.settings.mods).show(),c.$wrapper.show().scrollTop(),c.$modal.focus(),c.$modal.find("."+p+"-ajax").length&&c.$modal.find("."+p+"-ajax").empty(),c.$modal.find("."+p+"-tabs").length&&h(c),l(function(){k(c,w.closing)},function(){c.$bg.removeClass(c.settings.mods),c.$overlay.removeClass(c.settings.mods).hide(),c.$wrapper.hide(),j(!1),k(c,w.closed,!1,a)},c))},o.currentState=function(){return this.state},o.destroy=function(){var a,d=b[p].lookup;m(this),this.$wrapper.remove(),delete d[this.index],a=b.grep(d,function(a){return!!a}).length,0===a&&(this.$overlay.remove(),this.$bg.removeClass(c("is",w.closing)+" "+c("is",w.closed)+" "+c("is",w.opening)+" "+c("is",w.opened)))},b.fn[p]=function(a){var c,d;return this.each(function(e,f){d=b(f),null==d.data(p)?(c=new o(d,a),d.data(p,c.index),c.settings.trackUrlHash&&d.attr("data-"+p+"-id")===window.location.hash.substr(1)&&c.open()):c=b[p].lookup[d.data(p)]}),c},b(document).ready(function(){var a=b(document);a.on("click","[data-"+p+"-target]",function(a){a.preventDefault();var c=a.currentTarget,d=c.getAttribute("data-"+p+"-target"),e=b("[data-"+p+"-id="+d+"]");b[p].lookup[e.data(p)].open()}),a.on("keydown."+s,function(a){q&&q.settings.closeOnEsc&&q.state===w.opened&&27===a.keyCode&&q.close()}),b(window).on("hashchange."+s,n),a.find("."+s).each(function(a,c){var d=b(c);d[p]()})})});