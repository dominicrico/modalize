/*
 * Modalize - v0.0.1
 * Lightweight, responsive, fast, fully customizable modal plugin. Call your modals by url hash.
 * https://github.com/dominicrico/modalize
 *
 * Made by Dominic Rico-Gomez
 * Under MIT License
 */

!function(a,b){"function"==typeof define&&define.amd?define(["jquery"],function(c){return b(a,c)}):"object"==typeof exports?b(a,require("jquery")):b(a,a.jQuery||a.Zepto)}(this,function(a,b){"use strict";function c(){for(var a=t,b=0;b<arguments.length;b++)a+="-"+arguments[b];return a}function d(a){if(z&&"none"===a.css("animation-name")&&"none"===a.css("-ms-animation-name")&&"none"===a.css("-o-animation-name")&&"none"===a.css("-moz-animation-name")&&"none"===a.css("-webkit-animation-name"))return 0;var b=a.css("animation-duration")||a.css("-ms-animation-duration")||a.css("-o-animation-duration")||a.css("-moz-animation-duration")||a.css("-webkit-animation-duration")||"0s",c=a.css("animation-delay")||a.css("-ms-animation-delay")||a.css("-o-animation-delay")||a.css("-moz-animation-delay")||a.css("-webkit-animation-delay")||"0s",d=a.css("animation-iteration-count")||a.css("-ms-animation-iteration-count")||a.css("-o-animation-iteration-count")||a.css("-moz-animation-iteration-count")||a.css("-webkit-animation-iteration-count")||"1";b=b.split(", "),c=c.split(", "),d=d.split(", ");for(var e,f=Number.NEGATIVE_INFINITY,g=0;g<b.length;g++)e=parseFloat(b[g])*parseFloat(d[g],10)+parseFloat(c[g]),e>f&&(f=e);return e}function e(a,c){var d=["$bg","$overlay","$wrapper","$modal"];b.each(d,function(b,d){a[d].off(c)})}function f(a,c,d){var e=["$bg","$overlay","$wrapper","$modal"];b.each(e,function(b,e){a[e].on(c,d)})}function g(a){if(a.state!==x.opening&&a.state!==x.closing){var c,d=a.$modal.find("."+q+"-tabs > ul li");a.$modal.find("."+q+"-tabs [data-"+q+"-tab]").hide(),a.$modal.find("."+q+"-tabs [data-"+q+"-tab]:first").show(),a.$modal.find("."+q+"-tabs [data-"+q+"-show]:first").addClass("active"),a.tab=a.$modal.find("."+q+"-tabs ul li:first").attr("[data-"+q+"-show]"),b.each(d,function(e,f){c=b(f),c.css("width",100/d.length+"%"),void 0!==c.data(q+"-show")&&c.on("click."+t,function(c){c.preventDefault();var d=b(c.currentTarget);a.$modal.find("."+q+"-tabs .modalize-tab-select").removeClass("active"),a.$modal.find("."+q+"-tabs ."+q+"-tab").hide(),a.$modal.find("."+q+"-tabs [data-"+q+"-tab="+d.data(q+"-show")+"]").show(),d.addClass("active"),a.tab=d.data(q+"-show")})})}}function h(a){var c,d=a.$modal.find("."+q+"-tabs ul li");a.$modal.find("."+q+"-tabs [data-"+q+"-tab]").hide(),b.each(d,function(a,d){c=b(d),void 0!==c.data(q+"-show")&&c.off("click."+t)})}function i(){if(b(document.body).height()<=b(window).height())return 0;var a,c,d=document.createElement("div"),e=document.createElement("div");return d.style.visibility="hidden",d.style.width="100px",d.style.overflow="scroll",e.style.width="100%",document.body.appendChild(d),d.appendChild(e),c=d.offsetWidth,a=e.offsetWidth,d.parentNode.removeChild(d),c-a}function j(a){var d,e,f=b("html"),g=c("locked");a?f.hasClass(g)||(e=b(document.body),d=parseInt(e.css("padding-right"),10)+i(),e.css("padding-right",d+"px"),f.addClass(g)):f.hasClass(g)&&(e=b(document.body),d=parseInt(e.css("padding-right"),10)-i(),e.css("padding-right",d+"px"),f.removeClass(g))}function k(a,b,d,e){var f=c("is",b),g=[c("is",x.closing),c("is",x.closed),c("is",x.opening),c("is",x.opened)].join(" ");a.$bg.removeClass(g).addClass(f),a.$overlay.removeClass(g).addClass(f),a.$wrapper.removeClass(g).addClass(f),a.$modal.removeClass(g).addClass(f),a.state=b,!d&&a.$modal.trigger({type:b,reason:e},[{reason:e}])}function l(a,b,c){var g=0,h=function(a){a.target===this&&g++},i=function(a){a.target===this&&0===--g&&(e(c,u+" "+v),b())};f(c,u,h),f(c,v,i),a(),0===d(c.$bg)&&0===d(c.$overlay)&&0===d(c.$wrapper)&&0===d(c.$modal)&&(e(c,u+" "+v),b())}function m(a){a.state!==x.closed&&(e(a,u+" "+v),a.$bg.removeClass(a.settings.mods),a.$overlay.removeClass(a.settings.mods).hide(),a.$wrapper.hide(),j(!1),k(a,x.closed,!0))}function n(){var a,c,d=window.location.hash.replace("#","");if(d){try{c=b("[data-"+q+"-id="+d.replace(new RegExp("/","g"),"\\/")+"]")}catch(e){}c&&c.length&&(a=b[q].lookup[c.data(q)],a&&a.settings.trackUrlHash&&a.open())}else r&&r.state===x.opened&&r.settings.trackUrlHash&&r.close()}function o(a){var b,c,d,e,f={};for(a=a.replace(/\s*:\s*/g,":").replace(/\s*,\s*/g,","),b=a.split(","),e=0,c=b.length;c>e;e++)b[e]=b[e].split(":"),d=b[e][1],("string"==typeof d||d instanceof String)&&(d=isNaN(d)?"false"==d?!1:!0:+d),f[b[e][0]]=d;return f}function p(a,d){var e=b(document.body),f=this;f.settings=b.extend({},w,d),f.index=b[q].lookup.push(f)-1,f.state=x.closed,f.tab=void 0,f.$overlay=b("."+c("overlay")),f.$overlay.length||(f.$overlay=b("<div>").addClass(c("overlay")+" "+c("is",x.closed)).hide(),e.append(f.$overlay)),f.$bg=b("."+c("bg")).addClass(c("is",x.closed)),f.$modal=a.addClass(t+" "+c("is-initialized")+" "+f.settings.mods+" "+c("is",x.closed)).attr("tabindex","-1"),f.$wrapper=b("<div>").addClass(c("wrapper")+" "+f.settings.mods+" "+c("is",x.closed)).hide().append(f.$modal),e.append(f.$wrapper),f.$wrapper.on("click."+t,"[data-"+q+'-action="close"]',function(a){a.preventDefault(),f.close()}),f.$wrapper.on("click."+t,"[data-"+q+'-action="cancel"]',function(a){a.preventDefault(),f.$modal.trigger(y.CANCEL),f.settings.closeOnCancel&&f.close(y.CANCEL)}),f.$wrapper.on("click."+t,"[data-"+q+'-action="confirm"]',function(a){a.preventDefault(),f.$modal.trigger(y.CONFIRM),f.settings.closeOnConfirm&&f.close(y.CONFIRM)}),f.$wrapper.on("click."+t,function(a){b(a.target).hasClass(c("wrapper"))&&f.settings.closeOnOuterClick&&f.close()})}var q="modalize";b[q]={lookup:[]};var r,s,t=a.MODALIZE_GLOBALS&&a.MODALIZE_GLOBALS.NAMESPACE||q,u=b.map(["animationstart","webkitAnimationStart","MSAnimationStart","oAnimationStart"],function(a){return a+"."+t}).join(" "),v=b.map(["animationend","webkitAnimationEnd","MSAnimationEnd","oAnimationEnd"],function(a){return a+"."+t}).join(" "),w=b.extend({trackUrlHash:!0,closeOnConfirm:!0,closeOnCancel:!0,closeOnEsc:!0,closeOnOuterClick:!0,mods:""},a.MODALIZE_GLOBALS&&a.MODALIZE_GLOBALS.DEFAULTS),x={closing:"closing",closed:"closed",opening:"opening",opened:"opened"},y={CONFIRM:"confirmation",CANCEL:"cancellation"},z=function(){var a=document.createElement("div").style;return void 0!==a.animationName||void 0!==a.WebkitAnimationName||void 0!==a.MozAnimationName||void 0!==a.msAnimationName||void 0!==a.OAnimationName}();p.prototype.open=function(){var a,c,d=this;d.state!==x.opening&&d.state!==x.closing&&(a=d.$modal.attr("data-"+q+"-id"),a&&d.settings.trackUrlHash&&(s=b(window).scrollTop(),location.hash=a),r&&r!==d&&m(r),r=d,j(!0),d.$bg.addClass(d.settings.mods),d.$overlay.addClass(d.settings.mods).show(),d.$wrapper.show().scrollTop(),d.$modal.focus(),d.$modal.find("."+q+"-ajax").length&&(d.$modal.find("."+q+"-ajax").empty(),c=d.$modal.find("."+q+"-ajax").attr("data-"+q+"-ajax"),b.ajax({method:"GET",url:c,beforeSend:function(){d.$modal.find("."+q+"-confirm, ."+q+"-cancel").hide(),d.$modal.find("."+q+"-ajax").html('<h2><i class="icon-cycle icon-spin"></i> Loading data...</h2>')},success:function(a){d.$modal.find("."+q+"-confirm, ."+q+"-cancel").show(),d.$modal.find("."+q+"-ajax").html(a.output),d.$modal.find("."+q+"-tabs").length&&g(d)},error:function(a){d.$modal.find("."+q+"-ajax").html("<span>Ooops... Something went completly wrong! Sorry!</span>")}})),d.$modal.find("."+q+"-tabs").length&&g(d),l(function(){k(d,x.opening)},function(){k(d,x.opened)},d))},p.prototype.close=function(a){var c=this;c.state!==x.opening&&c.state!==x.closing&&(c.settings.trackUrlHash&&c.$modal.attr("data-"+q+"-id")===window.location.hash.substring(1)&&(window.location.hash="",b(window).scrollTop(s)),c.$bg.addClass(c.settings.mods),c.$overlay.addClass(c.settings.mods).show(),c.$wrapper.show().scrollTop(),c.$modal.focus(),c.$modal.find("."+q+"-ajax").length&&c.$modal.find("."+q+"-ajax").empty(),c.$modal.find("."+q+"-tabs").length&&h(c),l(function(){k(c,x.closing)},function(){c.$bg.removeClass(c.settings.mods),c.$overlay.removeClass(c.settings.mods).hide(),c.$wrapper.hide(),j(!1),k(c,x.closed,!1,a)},c))},p.prototype.currentState=function(){return this.state},p.prototype.currentTab=function(){return this.tab},p.prototype.destroy=function(){var a,d=b[q].lookup;m(this),this.$wrapper.remove(),delete d[this.index],a=b.grep(d,function(a){return!!a}).length,0===a&&(this.$overlay.remove(),this.$bg.removeClass(c("is",x.closing)+" "+c("is",x.closed)+" "+c("is",x.opening)+" "+c("is",x.opened)))},b.fn[q]=function(a){var c,d;return this.each(function(e,f){d=b(f),null==d.data(q)?(c=new p(d,a),d.data(q,c.index),c.settings.trackUrlHash&&d.attr("data-"+q+"-id")===window.location.hash.substr(1)&&c.open()):c=b[q].lookup[d.data(q)]}),c},b(document).ready(function(){var a=b(document);a.on("click","[data-"+q+"-target]",function(a){a.preventDefault();var c=a.currentTarget,d=c.getAttribute("data-"+q+"-target"),e=b("[data-"+q+"-id="+d+"]");b[q].lookup[e.data(q)].open()}),a.on("keydown."+t,function(a){r&&r.settings.closeOnEsc&&r.state===x.opened&&27===a.keyCode&&r.close()}),b(window).on("hashchange."+t,n),a.find("."+t).each(function(a,c){var d=b(c),e=d.data(q+"-options");e?("string"==typeof e||e instanceof String)&&(e=o(e)):e={},d[q](e)})})});